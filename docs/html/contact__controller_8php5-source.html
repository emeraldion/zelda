<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Emeraldion Lodge (codename Zelda): /Users/delphine/Sviluppo/SVN/emeraldion.it/zelda/controllers/contact_controller.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>/Users/delphine/Sviluppo/SVN/emeraldion.it/zelda/controllers/contact_controller.php</h1><a href="contact__controller_8php5.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002         require_once(<span class="stringliteral">"eme_controller.php"</span>);
<a name="l00003"></a>00003         require_once(dirname(__FILE__) . <span class="stringliteral">"/../helpers/contact_email.php"</span>);
<a name="l00004"></a>00004         require_once(dirname(__FILE__) . <span class="stringliteral">"/../helpers/cookie.php"</span>);
<a name="l00005"></a>00005         require_once(dirname(__FILE__) . <span class="stringliteral">"/../helpers/time.php"</span>);
<a name="l00006"></a>00006         require_once(dirname(__FILE__) . <span class="stringliteral">"/../helpers/antispam.php"</span>);
<a name="l00007"></a>00007 
<a name="l00012"></a><a class="code" href="class_contact_controller.html">00012</a>         <span class="keyword">class </span><a class="code" href="class_contact_controller.html" title="Controller for contact and mailing communication actions.">ContactController</a> <span class="keyword">extends</span> <a class="code" href="class_eme_controller.html" title="Main controller class for the Emeraldion Lodge.">EmeController</a>
<a name="l00013"></a>00013         {
<a name="l00019"></a><a class="code" href="class_contact_controller.html#b4d4491a0d798d597b0cfe1c3649bbb6">00019</a>                 <span class="keyword">protected</span> function <a class="code" href="class_contact_controller.html#b4d4491a0d798d597b0cfe1c3649bbb6" title="Initialization method for the Controller.">init</a>()
<a name="l00020"></a>00020                 {
<a name="l00021"></a>00021                         $this-&gt;<a class="code" href="class_base_controller.html#a3f4119163246e476fb326124362ea3f" title="Registers a function as a filter to be executed before the action is invoked.">before_filter</a>(array(<span class="stringliteral">'block_ip'</span>, <span class="stringliteral">'log_visit'</span>));
<a name="l00022"></a>00022                         $this-&gt;<a class="code" href="class_base_controller.html#362a1c08f8af5e2e50801482402d2e77" title="Registers a function as a filter to be executed after the action is invoked.">after_filter</a>(array(<span class="stringliteral">'shrink_html'</span>, <span class="stringliteral">'compress'</span>));
<a name="l00023"></a>00023                 }
<a name="l00024"></a>00024 
<a name="l00029"></a><a class="code" href="class_contact_controller.html#1e2fe04fc2229b201f8f334bf47ef73a">00029</a>                 <span class="keyword">public</span> function <a class="code" href="class_contact_controller.html#1e2fe04fc2229b201f8f334bf47ef73a" title="Default action method.">index</a>()
<a name="l00030"></a>00030                 {
<a name="l00031"></a>00031                         <span class="comment">//$this-&gt;redirect_to(array('action' =&gt; 'index', 'after' =&gt; 3));</span>
<a name="l00032"></a>00032                         $this-&gt;<a class="code" href="class_base_controller.html#6b34ce2554cc033c1b59820e8e4ef777" title="Sets the title for the current page.">set_title</a>(<span class="stringliteral">"Emeraldion Lodge .o. "</span> . <a class="code" href="common_8inc_8php5.html#367c038113690266a013d2e04a42a3b1" title="Shorthand method for the Localization::localize method.">l</a>(<span class="stringliteral">'Contact'</span>));
<a name="l00033"></a>00033                 }
<a name="l00034"></a>00034 
<a name="l00044"></a><a class="code" href="class_contact_controller.html#df97cc82d48f44236d258c1bb89b83e5">00044</a>                 <span class="keyword">public</span> function <a class="code" href="class_contact_controller.html#df97cc82d48f44236d258c1bb89b83e5" title="Sends the contact email if validation passes.">send</a>()
<a name="l00045"></a>00045                 {
<a name="l00046"></a>00046                         <span class="keywordflow">if</span> (!$this-&gt;request-&gt;is_post())
<a name="l00047"></a>00047                         {
<a name="l00048"></a>00048                                 $this-&gt;<a class="code" href="class_base_controller.html#90bf91f8b82c01c9b51d7b7b4e962045" title="Redirects the response to another action, or URL.">redirect_to</a>(array(<span class="stringliteral">'action'</span> =&gt; <span class="stringliteral">'index'</span>));
<a name="l00049"></a>00049                         }
<a name="l00050"></a>00050                         
<a name="l00051"></a>00051                         <span class="keywordflow">if</span> (!<a class="code" href="class_antispam.html#6ae89c9965c84df9685d004a9151ce1c" title="Verifies if the math test has been successful.">Antispam::check_math</a>())
<a name="l00052"></a>00052                         {
<a name="l00053"></a>00053                                 $this-&gt;<a class="code" href="class_base_controller.html#20db61f9bbfde123fb8afb1b3cf89638" title="Shows a message to the user, with an optional type qualifier.">flash</a>(<a class="code" href="class_antispam.html#ee06cc3951e93bcdb537db34dd76e8d5" title="Returns a variable message to alert the user that she&amp;#39;s failed the math test...">Antispam::random_comment</a>(), <span class="stringliteral">'error'</span>);
<a name="l00054"></a>00054                                 $this-&gt;<a class="code" href="class_base_controller.html#90bf91f8b82c01c9b51d7b7b4e962045" title="Redirects the response to another action, or URL.">redirect_to</a>(array(<span class="stringliteral">'action'</span> =&gt; <span class="stringliteral">'index'</span>));
<a name="l00055"></a>00055                         }
<a name="l00056"></a>00056                         <span class="comment">// A static class method would be infinitely better...</span>
<a name="l00057"></a>00057                         $contact_email = <span class="keyword">new</span> <a class="code" href="class_contact_email.html" title="Helper class to send contact emails to the website administrator.">ContactEmail</a>($_POST);
<a name="l00058"></a>00058                         $contact_email-&gt;send();
<a name="l00059"></a>00059                         
<a name="l00060"></a>00060                         <span class="keywordflow">if</span> (isset($_POST[<span class="stringliteral">'remember_me'</span>]))
<a name="l00061"></a>00061                         {
<a name="l00062"></a>00062                                 <a class="code" href="class_cookie.html#8c0266be76fe7dd64f098390f2cd2226">Cookie::set</a>(<span class="stringliteral">'name'</span>, $_POST[<span class="stringliteral">'name'</span>], <a class="code" href="class_time.html#8b92468712308b65881202435f6abb6a" title="Returs the number of seconds elapsed from the Unix Epoch to next year.">Time::next_year</a>());
<a name="l00063"></a>00063                                 <a class="code" href="class_cookie.html#8c0266be76fe7dd64f098390f2cd2226">Cookie::set</a>(<span class="stringliteral">'email'</span>, $_POST[<span class="stringliteral">'email'</span>], <a class="code" href="class_time.html#8b92468712308b65881202435f6abb6a" title="Returs the number of seconds elapsed from the Unix Epoch to next year.">Time::next_year</a>());
<a name="l00064"></a>00064                                 <a class="code" href="class_cookie.html#8c0266be76fe7dd64f098390f2cd2226">Cookie::set</a>(<span class="stringliteral">'URL'</span>, $_POST[<span class="stringliteral">'URL'</span>], <a class="code" href="class_time.html#8b92468712308b65881202435f6abb6a" title="Returs the number of seconds elapsed from the Unix Epoch to next year.">Time::next_year</a>());
<a name="l00065"></a>00065                         }
<a name="l00066"></a>00066                         $this-&gt;<a class="code" href="class_base_controller.html#90bf91f8b82c01c9b51d7b7b4e962045" title="Redirects the response to another action, or URL.">redirect_to</a>(array(<span class="stringliteral">'action'</span> =&gt; <span class="stringliteral">'thank_you'</span>));
<a name="l00067"></a>00067                 }
<a name="l00068"></a>00068                 
<a name="l00074"></a><a class="code" href="class_contact_controller.html#2f4d13ca2f700b0d701565319c1a716c">00074</a>                 <span class="keyword">public</span> function <a class="code" href="class_contact_controller.html#2f4d13ca2f700b0d701565319c1a716c" title="Shows thankfulness to the user for the contact email.">thank_you</a>()
<a name="l00075"></a>00075                 {
<a name="l00076"></a>00076                         $this-&gt;<a class="code" href="class_base_controller.html#90bf91f8b82c01c9b51d7b7b4e962045" title="Redirects the response to another action, or URL.">redirect_to</a>(array(<span class="stringliteral">'controller'</span> =&gt; <span class="stringliteral">'home'</span>, <span class="stringliteral">'after'</span> =&gt; 10));
<a name="l00077"></a>00077                 }
<a name="l00078"></a>00078         }
<a name="l00079"></a>00079 ?&gt;
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun May 4 13:26:40 2008 for Emeraldion Lodge (codename Zelda) by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
